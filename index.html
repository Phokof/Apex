<!DOCTYPE html>
<html lang="en">
<head>
<link rel="stylesheet" href="spectre.min.css">
<script type="text/javascript">
function impact(games, top3, damage, kills, revives) {
  if (games === 0) return 0;
  const damagePerGame = damage / games,
        killsRevsPerGame = (kills + revives) / games, // We consider kills and revives equal
        top3chance = top3 / games;

  /* Explanation of the success factor:
     While the result mostly depends on other performance variables,
     the ratio of a player's Top 3 placements and total games played should have some weight.

     In order to not encourage camping, using a logarithmic scale does not heavily reward high ratios.
     On the other end of the spectrum are those who take huge risks, like landing on a supply ship,
     having high battle stats but rarely make it to the end game regardless; following scale punishes that.

     Examples:
     Chance to get to Top 3 | Success factor
     ---------------------------------------
     10 %                   | 0.50
     30 %                   | 0.66 (+0.16)
     50 %                   | 0.77 (+0.11)
     70 %                   | 0.87 (+0.10)
     90 %                   | 0.96 (+0.09)

     Therefore farming Top 3 ratio would have diminishing returns.
  */
  const successFactor = 1 - Math.log10(top3chance);

  return damagePerGame * killsRevsPerGame * successFactor;
}
</script>
</head>
<body>
<div class="container">
  <h1>Apex Legends - Performance Rating calculator</h1>
  <div class="columns">
    <div class="column col-3">
      <div class="form-group">
        <fieldset>
          <legend>Please input a legend's stats:</legend>

          <label class="form-label" for="games">Games Played:</label>
          <input class="form-input" name="games" type="number" min="30" required>

          <label class="form-label" for="top3">Times Placed Top 3:</label>
          <input class="form-input" name="top3" type="number" min="0" required>

          <label class="form-label" for="damage">Damage Done:</label>
          <input class="form-input" name="damage" type="number" min="0" required>

          <label class="form-label" for="kills">Kills:</label>
          <input class="form-input" name="kills" type="number" min="0" required>

          <label class="form-label" for="revives">Revives:</label>
          <input class="form-input" name="revives" type="number" min="0" required>

        </fieldset>
        <input type="submit" value="Calculate">
      </div>
    </div>
    <div class="column col-9" id="results" hidden>
      <div class="hero">
        <div class="hero-body">
          <h1>Result: <span id="result" style="color:GoldenRod;"></span></h1>
          <p><a href="https://github.com/Phokof/Apex/blob/master/index.html#L6-L34">How is this calculated?</a></p>
        </div>
      </div>
    </div>
  </div>
</div>
<body>
  <script type="text/javascript">
  document.querySelector('input[type="submit"]').addEventListener('click', evt => {
    evt.preventDefault();
    let score = impact(
      parseInt(document.querySelector('input[name="games"]').value),
      parseInt(document.querySelector('input[name="top3"]').value),
      parseInt(document.querySelector('input[name="damage"]').value),
      parseInt(document.querySelector('input[name="kills"]').value),
      parseInt(document.querySelector('input[name="revives"]').value)
    );
    document.querySelector('#result').textContent = String(Math.round(score));
    document.querySelector('#results').hidden = false;
  });
  </script>
</html>
